<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªÙ‚Ø³ÙŠÙ… Ù…Ø³Ø§Ø­Ø© Ø´Ø¨Ù‡ Ø§Ù„Ù…Ù†Ø­Ø±Ù Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹Ø§Øª</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" href="icon.png">
  <meta name="theme-color" content="#3498db">
  <style>
    body {
        font-family: 'Tajawal', sans-serif;
        margin: 0;
        padding: 0;
        background-color: var(--bg-light);
        color: var(--text-light);
        direction: rtl;
        transition: background-color 0.3s, color 0.3s;
    }

    .container {
        padding: 15px;
        max-width: 600px;
        margin: 0 auto;
    }

    .card {
        background: var(--card-light);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        border: 1px solid var(--border-light);
        border-radius: 22px;
        padding: 24px;
        margin-bottom: 20px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.03);
        transition: all 0.3s ease;
    }

    .dark-mode .card {
        background: var(--card-dark);
        border: 1px solid var(--border-dark);
        box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    }

    h3 {
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 20px;
        color: var(--primary);
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .input-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
    }

    .input-group {
        margin-bottom: 18px;
        text-align: right;
    }

    .input-group label {
        display: block;
        margin-bottom: 10px;
        font-size: 0.95rem;
        font-weight: 600;
        color: var(--text-light);
        opacity: 0.8;
    }

    .dark-mode .input-group label {
        color: var(--text-dark);
    }

    .result-card {
        margin-top: 20px;
        padding: 20px;
        background: rgba(0, 122, 255, 0.1);
        border-radius: 18px;
        border-right: 6px solid var(--primary);
        transition: all 0.3s ease;
    }

    .dark-mode .result-card {
        background: rgba(0, 122, 255, 0.15);
        border-right-color: var(--primary);
    }

    .section-item {
        background: rgba(255, 255, 255, 0.5);
        padding: 15px;
        border-radius: 14px;
        margin-top: 10px;
        font-size: 0.95rem;
        border: 1px solid rgba(0,0,0,0.05);
        backdrop-filter: blur(5px);
    }

    .dark-mode .section-item {
        background: rgba(255, 255, 255, 0.05);
        border-color: rgba(255, 255, 255, 0.1);
    }

    /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø³Ù…Ø© Ø¹Ø´Ø§Ù† ØªÙƒÙˆÙ† Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ…Ø±ÙŠØ± */
    .canvas-scroll-container {
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        margin: 25px 0 10px;
        padding: 5px;
        cursor: grab;
    }

    .canvas-scroll-container:active {
        cursor: grabbing;
    }

    canvas {
        display: block;
        margin: 0 auto;
        background: var(--card-light);
        border-radius: 16px;
        border: 1px solid var(--border-light);
        /* Ø´ÙŠÙ„Ù†Ø§ Ø§Ù„Ù€ max-width Ø¹Ø´Ø§Ù† ÙŠÙ‚Ø¯Ø± ÙŠØ®Ø±Ø¬ Ø¹Ù† Ø§Ù„Ø´Ø§Ø´Ø© ÙˆÙ†Ù…Ø±Ø±Ù‡ */
    }

    .dark-mode canvas {
        background: var(--card-dark);
        border: 1px solid var(--border-dark);
    }
</style>
</head>
<body class="mobile-view">
    <div class="container">
        <div class="card">
            <h3><i class="fas fa-layer-group"></i> ØªÙ‚Ø³ÙŠÙ… Ø´Ø¨Ù‡ Ø§Ù„Ù…Ù†Ø­Ø±Ù</h3>
            
            <div class="input-grid">
                <div class="input-group">
                    <label>Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ØµØºØ±Ù‰ (a):</label>
                    <input type="number" id="a" step="any" placeholder="0.00" oninput="calculate()">
                </div>
                <div class="input-group">
                    <label>Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰ (b):</label>
                    <input type="number" id="b" step="any" placeholder="0.00" oninput="calculate()">
                </div>
                <div class="input-group">
                    <label>Ø§Ù„Ù…Ø§Ø¦Ù„ Ø§Ù„Ø£ÙˆÙ„ (L1):</label>
                    <input type="number" id="L1" step="any" placeholder="0.00" oninput="calculate()">
                </div>
                <div class="input-group">
                    <label>Ø§Ù„Ù…Ø§Ø¦Ù„ Ø§Ù„Ø«Ø§Ù†ÙŠ (L2):</label>
                    <input type="number" id="L2" step="any" placeholder="0.00" oninput="calculate()">
                </div>
            </div>

            <div class="input-group">
                <label>Ø§Ù„Ø§Ø±ØªÙØ§Ø¹Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ù…Ø«Ø§Ù„: 5, 10, 15):</label>
                <input type="text" id="heights" placeholder="Ø§ÙØµÙ„ Ø¨ÙŠÙ†Ù‡Ø§ Ø¨ÙØ§ØµÙ„Ø©" oninput="calculate()">
            </div>

            <div id="results" class="hidden"></div>
            
            <!-- Ù‡Ù†Ø§ ÙŠØ§ Ø³ÙŠØ¯ÙŠ Ù‡Ù†Ø±Ø³Ù… Ø§Ù„Ù…Ù†Ø­Ø±Ù Ø¨Ø§Ù„ØªÙ‚Ø³ÙŠÙ…Ø§Øª Ø¨ØªØ§Ø¹Ø© ÙŠÙˆØ³Ù Ø§Ù„Ø²ØºØ¨ÙŠ -->
            <div class="canvas-scroll-container" id="canvasScroll">
                <canvas id="trapezoidCanvas"></canvas>
            </div>
            
            <button id="saveBtn" class="save-btn hidden" onclick="saveResult()">
                <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            </button>
        </div>
    </div>

    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark-mode');
        }

        function drawTrapezoidDivision(a, b, L1, L2, h, divisionHeights) {
            const canvas = document.getElementById('trapezoidCanvas');
            const ctx = canvas.getContext('2d');
            
            // ØªØ¸Ø¨ÙŠØ· Ù…Ù‚Ø§Ø³ Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³ Ø¹Ø´Ø§Ù† ÙŠØ¨Ù‚Ù‰ ÙƒØ¨ÙŠØ± ÙˆÙˆØ§Ø¶Ø­ ÙˆÙ†Ù‚Ø¯Ø± Ù†Ù…Ø³Ø­Ù‡
            // Ù‡Ù†Ø®Ù„ÙŠ Ø§Ù„Ø¹Ø±Ø¶ 1000 ÙˆØ§Ù„Ø§Ø±ØªÙØ§Ø¹ 600 Ø¹Ø´Ø§Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„ ØªØ¨Ø§Ù† ÙˆØ§Ù„Ø³ÙƒØ±ÙˆÙˆÙ„ ÙŠØ´ØªØºÙ„
            canvas.width = 1000;
            canvas.height = 600;
            const padding = 80; // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¨Ø§Ø¯Ù†Ø¬ Ø¹Ø´Ø§Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù…ØªØ·Ù„Ø¹Ø´ Ø¨Ø±Ù‡
            const drawW = canvas.width - padding * 2;
            const drawH = canvas.height - padding * 2;

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Ù„Ùˆ Ø§Ù„Ø¯Ø§ØªØ§ Ù…Ø´ ÙƒØ§Ù…Ù„Ø© Ù†Ø®Ø±Ø¬
            if (!a || !b || !L1 || !L2 || h <= 0) return;

            // Ø­Ø³Ø§Ø¨ Ù…ÙƒØ§Ù† Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ØµØºØ±Ù‰ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù„ÙƒØ¨Ø±Ù‰
            // x1 Ù‡ÙŠ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„Ø£ÙÙ‚ÙŠØ© Ù…Ù† Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰ Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ØµØºØ±Ù‰
            const x1 = (b * b + L1 * L1 - L2 * L2 - a * a) / (2 * (b - a));
            const x_offset = x1; 

            // ØªØ¸Ø¨ÙŠØ· Ø§Ù„Ù€ Scale - Ø¨Ù†ÙƒØ¨Ø± Ø§Ù„Ø±Ø³Ù…Ø© Ø¹Ø´Ø§Ù† ØªÙ…Ù„Ù‰ Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³ Ø§Ù„Ù€ 1000px
            const scale = Math.min(drawW / Math.max(a, b), drawH / h);
            
            // ØªÙˆØ³ÙŠØ· Ø§Ù„Ø±Ø³Ù…Ø© ÙÙŠ Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³
            const startX = (canvas.width - b * scale) / 2;
            const startY = canvas.height - padding;

            // Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù†Ù‚Ø·
            const p1 = { x: startX, y: startY }; // Ø´Ù…Ø§Ù„ ØªØ­Øª (Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰)
            const p2 = { x: startX + b * scale, y: startY }; // ÙŠÙ…ÙŠÙ† ØªØ­Øª (Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰)
            const p3 = { x: startX + (x_offset + a) * scale, y: startY - h * scale }; // ÙŠÙ…ÙŠÙ† ÙÙˆÙ‚
            const p4 = { x: startX + x_offset * scale, y: startY - h * scale }; // Ø´Ù…Ø§Ù„ ÙÙˆÙ‚

            const isDarkMode = document.documentElement.classList.contains('dark-mode');
            const textColor = isDarkMode ? '#ffffff' : '#1a1a1a';
            const strokeColor = isDarkMode ? '#4dabf7' : '#1971c2';
            const divisionColor = isDarkMode ? '#ff922b' : '#e67e22';
            const areaFillColor = isDarkMode ? 'rgba(77, 171, 247, 0.1)' : 'rgba(25, 113, 194, 0.05)';

            // Ø±Ø³Ù… Ø®Ù„ÙÙŠØ© Ø®ÙÙŠÙØ© Ù„Ù„Ø´ÙƒÙ„
            ctx.beginPath();
            ctx.moveTo(p1.x, p1.y);
            ctx.lineTo(p2.x, p2.y);
            ctx.lineTo(p3.x, p3.y);
            ctx.lineTo(p4.x, p4.y);
            ctx.closePath();
            ctx.fillStyle = areaFillColor;
            ctx.fill();

            ctx.lineWidth = 4;
            ctx.strokeStyle = strokeColor;
            ctx.lineJoin = 'round';
            ctx.stroke();

            // Ø±Ø³Ù… Ø®Ø·ÙˆØ· Ø§Ù„ØªÙ‚Ø³ÙŠÙ…
            ctx.setLineDash([8, 6]);
            ctx.strokeStyle = divisionColor;
            ctx.lineWidth = 2;
            ctx.font = 'bold 14px Tajawal, Arial';
            ctx.fillStyle = textColor;
            ctx.textAlign = 'center';

            divisionHeights.forEach(dh => {
                if (dh > 0 && dh < h) {
                    const ratio = dh / h;
                    // Ø§Ù„Ù†Ù‚Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø¶Ù„Ø¹ÙŠÙ† Ø§Ù„Ù…Ø§Ø¦Ù„ÙŠÙ† (Ø¨Ù†Ø§Ø®Ø¯ Ø§Ù„Ù†Ø³Ø¨Ø© Ù…Ù† Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„ÙƒÙ„ÙŠ)
                    const dL = {
                        x: p1.x + (p4.x - p1.x) * ratio,
                        y: p1.y + (p4.y - p1.y) * ratio
                    };
                    const dR = {
                        x: p2.x + (p3.x - p2.x) * ratio,
                        y: p2.y + (p3.y - p2.y) * ratio
                    };

                    ctx.beginPath();
                    ctx.moveTo(dL.x, dL.y);
                    ctx.lineTo(dR.x, dR.y);
                    ctx.stroke();

                    // Ù†ÙƒØªØ¨ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø· Ø¨Ø´ÙƒÙ„ Ø´ÙŠÙƒ
                    ctx.fillText(`h = ${dh.toFixed(2)}`, (dL.x + dR.x) / 2, dL.y - 10);
                }
            });

            ctx.setLineDash([]); // Ù†Ø±Ø¬Ø¹ Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ø§Ø¯ÙŠ

            // ÙƒØªØ§Ø¨Ø© Ø£Ø·ÙˆØ§Ù„ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            ctx.fillStyle = textColor;
            ctx.font = 'bold 16px Tajawal, Arial';
            
            // Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰ (b)
            ctx.fillText(`Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰: ${b.toFixed(2)}`, (p1.x + p2.x) / 2, p1.y + 35);
            
            // Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ØµØºØ±Ù‰ (a)
            ctx.fillText(`Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ØµØºØ±Ù‰: ${a.toFixed(2)}`, (p3.x + p4.x) / 2, p3.y - 20);
            
            // Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹ Ø§Ù„Ù…Ø§Ø¦Ù„Ø©
            ctx.save();
            ctx.translate((p1.x + p4.x) / 2, (p1.y + p4.y) / 2);
            const angleL = Math.atan2(p4.y - p1.y, p4.x - p1.x);
            ctx.rotate(angleL);
            ctx.fillText(L1.toFixed(2), 0, -15);
            ctx.restore();

            ctx.save();
            ctx.translate((p2.x + p3.x) / 2, (p2.y + p3.y) / 2);
            const angleR = Math.atan2(p3.y - p2.y, p3.x - p2.x);
            ctx.rotate(angleR);
            ctx.fillText(L2.toFixed(2), 0, -15);
            ctx.restore();

            // Ø±Ø³Ù… Ø³Ù‡Ù… Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„ÙƒÙ„ÙŠ ÙÙŠ Ø§Ù„Ø¬Ù†Ø¨
            const hX = p1.x - 40;
            ctx.beginPath();
            ctx.strokeStyle = textColor;
            ctx.lineWidth = 1;
            ctx.moveTo(hX, p1.y);
            ctx.lineTo(hX, p4.y);
            ctx.stroke();
            
            // Ø±Ø¤ÙˆØ³ Ø§Ù„Ø³Ù‡Ù…
            ctx.beginPath();
            ctx.moveTo(hX - 5, p1.y - 5); ctx.lineTo(hX, p1.y); ctx.lineTo(hX + 5, p1.y - 5);
            ctx.moveTo(hX - 5, p4.y + 5); ctx.lineTo(hX, p4.y); ctx.lineTo(hX + 5, p4.y + 5);
            ctx.stroke();

            ctx.save();
            ctx.translate(hX - 15, (p1.y + p4.y) / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText(`H = ${h.toFixed(2)}`, 0, 0);
            ctx.restore();
        }

        function calculate() {
            const a = parseFloat(document.getElementById("a").value);
            const b = parseFloat(document.getElementById("b").value);
            const L1 = parseFloat(document.getElementById("L1").value);
            const L2 = parseFloat(document.getElementById("L2").value);
            const heightsStr = document.getElementById("heights").value;
            const heights = heightsStr.split(',').map(s => parseFloat(s.trim())).filter(n => !isNaN(n));

            const resultsDiv = document.getElementById("results");
            const saveBtn = document.getElementById("saveBtn");

            if (isNaN(a) || isNaN(b) || isNaN(L1) || isNaN(L2) || heights.length === 0) {
                resultsDiv.classList.add("hidden");
                saveBtn.classList.add("hidden");
                return;
            }

            const baseDifference = (b - a) / 2;
            const h1 = Math.sqrt(Math.max(0, L1 * L1 - baseDifference * baseDifference));
            const h2 = Math.sqrt(Math.max(0, L2 * L2 - baseDifference * baseDifference));
            const totalHeight = (h1 + h2) / 2;

            if (isNaN(totalHeight) || totalHeight <= 0) {
                resultsDiv.innerHTML = '<p style="color: red; text-align: center;">Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ØºÙŠØ± ØµØ­ÙŠØ­Ø© ÙŠØ§ Ù‡Ù†Ø¯Ø³Ø©</p>';
                resultsDiv.classList.remove("hidden");
                return;
            }

            const totalArea = ((a + b) / 2) * totalHeight;
            resultsDiv.classList.remove("hidden");
            saveBtn.classList.remove("hidden");
            
            let html = `
                <div class="result-card">
                    <strong>Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„ÙƒÙ„ÙŠØ©: ${totalArea.toFixed(2)} Ù…ØªØ±Â²</strong>
                </div>
                <h4 style="margin: 15px 0 10px;">Ø§Ù„Ø£Ù‚Ø³Ø§Ù…:</h4>
            `;

            let currentTopBase = a;
            let currentBottomBase = b;
            let remainingHeight = totalHeight;
            let totalUsedArea = 0;

            for (let i = 0; i < heights.length; i++) {
                const height = heights[i];
                if (height > remainingHeight) {
                    html += `<p style="color:orange; font-size:0.8rem;">Ø§Ù„Ù‚Ø³Ù… ${i+1} ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ!</p>`;
                    break;
                }

                const newBase = currentTopBase + ((currentBottomBase - currentTopBase) / remainingHeight) * height;
                const area = ((currentTopBase + newBase) / 2) * height;
                const conv = convertToFeddans(area);

                html += `
                    <div class="section-item">
                        <strong>Ø§Ù„Ù‚Ø³Ù… ${i + 1}:</strong> ${area.toFixed(2)} Ù…ØªØ±Â²<br>
                        <small>${conv.feddan} ÙØ¯Ø§Ù†ØŒ ${conv.qirat} Ù‚ÙŠØ±Ø§Ø·ØŒ ${conv.sahm} Ø³Ù‡Ù…</small><br>
                        <small>Ù‚Ø§Ø¹Ø¯Ø© Ø¹Ù„ÙˆÙŠØ©: ${currentTopBase.toFixed(2)} | Ø³ÙÙ„ÙŠØ©: ${newBase.toFixed(2)}</small>
                    </div>
                `;

                currentTopBase = newBase;
                remainingHeight -= height;
                totalUsedArea += area;
            }

            if (remainingHeight > 0.01) {
                const remainingArea = totalArea - totalUsedArea;
                const conv = convertToFeddans(remainingArea);
                html += `
                    <div class="result-card" style="margin-top:15px; background: #fff3e0; border-right-color: #ff9800;">
                        <strong>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</strong> ${remainingArea.toFixed(2)} Ù…ØªØ±Â²<br>
                        <small>Ø§Ø±ØªÙØ§Ø¹ Ù…ØªØ¨Ù‚ÙŠ: ${remainingHeight.toFixed(2)} Ù…ØªØ±</small>
                    </div>
                `;
            }

            resultsDiv.innerHTML = html;
            // ÙŠØ§ Ù…Ø¹Ù„Ù…ØŒ Ù†Ø±Ø³Ù… Ø§Ù„Ù…Ù†Ø­Ø±Ù Ø¨Ø§Ù„ØªÙ‚Ø³ÙŠÙ…Ø§Øª
            drawTrapezoidDivision(a, b, L1, L2, totalHeight, heights);
        }

        function convertToFeddans(m2) {
            const feddan = 4200.83;
            const qirat = 175.034;
            const sahm = 7.293;

            let remaining = m2;
            let f = Math.floor(remaining / feddan);
            remaining -= f * feddan;
            let q = Math.floor(remaining / qirat);
            remaining -= q * qirat;
            let s = remaining / sahm;

            return { feddan: f, qirat: q, sahm: s.toFixed(2) };
        }

        function saveResult() {
            const resultsDiv = document.getElementById("results");
            const data = {
                type: "ØªÙ‚Ø³ÙŠÙ… Ø´Ø¨Ù‡ Ù…Ù†Ø­Ø±Ù (Ø§Ø±ØªÙØ§Ø¹Ø§Øª)",
                result: "Ù†ØªØ§Ø¦Ø¬ ØªÙ‚Ø³ÙŠÙ… Ø´Ø¨Ù‡ Ù…Ù†Ø­Ø±Ù",
                details: resultsDiv.innerText
            };

            if (window.firebaseLogic && window.firebaseLogic.saveResult) {
                window.firebaseLogic.saveResult(data)
                    .then(() => alert('ØªÙ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø© ÙŠØ§ Ø±ÙŠØ³! ğŸ˜'))
                    .catch(() => alert('Ø§ØªØ­ÙØ¸Øª Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¨Ø³ Ø¹Ø´Ø§Ù† ÙÙŠÙ‡ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©'));
            } else {
                let savedResults = JSON.parse(localStorage.getItem('savedResults') || '[]');
                data.timestamp = new Date().toISOString();
                savedResults.push(data);
                localStorage.setItem('savedResults', JSON.stringify(savedResults));
                alert('ØªÙ… Ø§Ù„Ø­ÙØ¸ Ù…Ø­Ù„ÙŠØ§Ù‹ ÙŠØ§ Ø±ÙŠØ³! ğŸ˜');
            }
        }

        // Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ø§Ù„Ø³Ø­Ø¨ Ø¨Ø§Ù„Ù…Ø§ÙˆØ³ Ù„Ù„ØªÙ…Ø±ÙŠØ±
        const scrollContainer = document.getElementById('canvasScroll');
        let isDown = false;
        let startX;
        let scrollLeft;

        scrollContainer.addEventListener('mousedown', (e) => {
            isDown = true;
            scrollContainer.classList.add('active');
            startX = e.pageX - scrollContainer.offsetLeft;
            scrollLeft = scrollContainer.scrollLeft;
        });
        scrollContainer.addEventListener('mouseleave', () => {
            isDown = false;
        });
        scrollContainer.addEventListener('mouseup', () => {
            isDown = false;
        });
        scrollContainer.addEventListener('mousemove', (e) => {
            if(!isDown) return;
            e.preventDefault();
            const x = e.pageX - scrollContainer.offsetLeft;
            const walk = (x - startX) * 2; // Ø³Ø±Ø¹Ø© Ø§Ù„Ø³Ø­Ø¨
            scrollContainer.scrollLeft = scrollLeft - walk;
        });
    </script>
</body>
</html>
